{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resultados da Pesquisa - Nexus HC</title>
    <link rel="stylesheet" href="{% static 'busca/style.css' %}">
</head>

<body>

<header>
    <a href="/" class="back-button">‚Üê Voltar</a>
    <h1>Resultados da Pesquisa</h1>
</header>

<div class="container">

    <div class="results-box">

        {% if query %}
            <h2>Resultados para: <span style="color:#1976D2;">"{{ query }}"</span></h2>
        {% else %}
            <h2>Resultados da Pesquisa</h2>
        {% endif %}

        {% if data_inicio or data_fim %}
            <p style="margin-top:10px;">
                <strong>Per√≠odo:</strong>
                {% if data_inicio %} a partir de {{ data_inicio }} {% endif %}
                {% if data_fim %} at√© {{ data_fim }} {% endif %}
            </p>
        {% endif %}

        {% if artigos %}
            <ul class="article-list">
                {% for art in artigos %}
                    <li class="article-item">

                        <h3>{{ art.titulo }}</h3>

                        {% if art.autores %}
                            <p><strong>Autores:</strong> {{ art.autores }}</p>
                        {% endif %}

                        {% if art.data_publicacao %}
                            <p><strong>Publicado em:</strong> {{ art.data_publicacao }}</p>
                        {% endif %}

                        {% if art.pmid %}
                            <p><strong>PMID:</strong> {{ art.pmid }}</p>
                        {% endif %}

                        <a class="article-link" href="{{ art.link }}" target="_blank">
                            Acessar Artigo
                        </a>

                        <!-- ‚≠ê ADICIONADO AQUI: FORMUL√ÅRIO PARA SALVAR ARTIGO -->
                        <form action="{% url 'salvar_artigo' %}" method="POST" style="margin-top:8px;">
                            {% csrf_token %}
                            <input type="hidden" name="titulo" value="{{ art.titulo }}">
                            <input type="hidden" name="autores" value="{{ art.autores }}">
                            <input type="hidden" name="ano" value="{{ art.data_publicacao }}">
                            <input type="hidden" name="link" value="{{ art.link }}">
                            <input type="hidden" name="resumo" value="{{ art.resumo }}">
                        
                            <button type="submit" class="save-btn">Salvar Artigo</button>
                        </form>
                        <!-- ‚≠ê FIM DO TRECHO ADICIONADO -->

                        {% if user.is_staff %}
                            <!-- üî• BOT√ÉO EXCLUIR PARA ADMIN -->
                            <form method="POST" action="{% url 'excluir_artigo' art.id %}" style="display:inline;">
                                {% csrf_token %}
                                <button type="submit" class="delete-btn"
                                        onclick="return confirm('Tem certeza que deseja excluir este artigo?');">
                                    Excluir Artigo
                                </button>
                            </form>
                        {% endif %}

                    </li>
                {% endfor %}
            </ul>
        {% else %}
            <p style="margin-top:20px; font-size:1.1em;">
                Nenhum artigo encontrado para a busca informada.
            </p>
        {% endif %}

    </div>

</div>

<script src="{% static 'busca/script.js' %}?v=3"></script>

</body>
</html>
