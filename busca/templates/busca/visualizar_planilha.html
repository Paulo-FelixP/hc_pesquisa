<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ planilha.nome }}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        body { background:#f4f5f7; }
        .card { border-radius:14px; transition:0.2s; }
        .card:hover { transform:translateY(-3px); }
        .item-header { font-weight:600; font-size:1.1rem; }
        .origin-tag {
            display:inline-block;
            padding:3px 8px;
            border-radius:6px;
            font-size:0.75rem;
            background:#0B63B7;
            color:white;
        }
    </style>
</head>

<body>

<div class="container my-5">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold">{{ planilha.nome }}</h2>

        <div class="d-flex gap-2">

            <a href="{% url 'lista_planilhas' %}" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Voltar
            </a>

            <a href="{% url 'download_planilha' planilha.id %}" class="btn btn-success">
                <i class="bi bi-download"></i> Baixar CSV
            </a>

            <a href="{% url 'apagar_planilha' planilha.id %}"
               onclick="return confirm('Apagar planilha inteira?')"
               class="btn btn-danger">
                <i class="bi bi-trash"></i>
            </a>

        </div>
    </div>

    {% if mensagens %}
        {% for msg in mensagens %}
            <div class="alert alert-{{ msg.tags }}">{{ msg }}</div>
        {% endfor %}
    {% endif %}

    {% if itens %}
        <div class="row g-4">
            {% for item in itens %}
            <div class="col-md-6 col-lg-4">

                <div class="card shadow-sm">
                    <div class="card-body">

                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <span class="origin-tag">{{ item.origem|title }}</span>

                            <a href="{% url 'remover_item' planilha.id item.id %}"
                               onclick="return confirm('Remover este artigo da planilha?')"
                               class="text-danger fs-5">
                                <i class="bi bi-x-circle-fill"></i>
                            </a>
                        </div>

                        <h5 class="item-header mb-2">
                            {{ item.titulo }}
                        </h5>

                        {% if item.autores %}
                        <p class="mb-1"><strong>Autores:</strong> {{ item.autores }}</p>
                        {% endif %}

                        {% if item.data_publicacao %}
                        <p class="mb-1"><strong>Publicação:</strong> {{ item.data_publicacao }}</p>
                        {% endif %}

                        {% if item.resumo %}
                        <p class="text-muted small mt-2">
                            {{ item.resumo|truncatechars:180 }}
                        </p>
                        {% endif %}

                        <a href="{{ item.link }}" target="_blank"
                           class="btn btn-outline-primary w-100 mt-2">
                            <i class="bi bi-box-arrow-up-right"></i> Abrir Artigo
                        </a>

                    </div>
                </div>

            </div>
            {% endfor %}
        </div>

    {% else %}
        <div class="alert alert-info text-center mt-5">
            Nenhum artigo nesta planilha ainda.
        </div>
    {% endif %}
</div>


<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
